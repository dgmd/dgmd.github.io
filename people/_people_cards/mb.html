<div id='mb' class='person flip-container'>
    <div class='flipper'>
      
      <div class='front card'>
        <h2>Michelle B.</h2>
        <div class='headshot'>
          <!-- Skull from https://pixabay.com/p-185527/?no_redirect -->
          <img id='headshot_overlay_shot' src='http://i.imgur.com/fRh2wWm.png'></img>
          <img id='headshot_overlay_bond' src='http://i.imgur.com/V8uw7KV.png'>
        </div>
        <i class="fa fa-undo flip"></i>
      </div>

    <div class='back card'>
      <ul>
        <li><i class="fa fa-github"></i><a href="https://github.com/knod">knod</a>
        </li>
        <li><i class="fa fa-twitter"></i><a href="https://twitter.com/exvelarplosive">@exvelarplosive</a>
        </li>
        <li><i class="fa fa-envelope"></i><a href="mailto:knodding@gmail.com">knodding<br>@gmail.com</a>
        </li>
        <li><i class="fa fa-cogs"></i><a href="https://www.youtube.com/watch?v=PUv66718DII">What coding should feel  like</a>
        </li>
      </ul>
      <i class="fa fa-undo flip"></i>
    </div>
  </div>
  <script>
  // ===================
  // Start Custom Code
  // ===================
  window.addEventListener( 'load', function() {
    var myCard = document.querySelector('#mb');
    var headshot = myCard.querySelector('.headshot');
    // --------------------------- \\
    // --- STARTING POSITIONS --- \\
    var jamesBondNode = document.getElementById( 'headshot_overlay_bond' );
    
    var nodeLeft, nodeTop;
    var setStartingPosData = function ( node ) {
    /* Position relative to offsetParent, for left and top style properties, for recentering */

      node.dataset[ 'left' ] = node.style.left;
      node.dataset[ 'top' ] = node.style.top;
      
      // Gives number values?
      nodeLeft = node.offsetLeft;
      nodeTop = node.offsetTop;

      return node;
    };  // End getStartingPos()
    
    setStartingPosData( jamesBondNode );
    
    // ----------------- \\
    // --- RESPONSIVE MOVEMENT --- \\
    var getMouseRelativeTo = function( evnt, node ) {
    /* ( event, node ) -> {x: float, y: float}
    * 
    * Get distance of mouse from center of node
    */
      // Get mouse position in window
      var mouseX = evnt.clientX,
          mouseY = evnt.clientY;

      // Get current center of myCard relative to window
      var rect = node.getBoundingClientRect();
      var nodeX = rect.left, nodeY = rect.top,
          nodeW = rect.width, nodeH = rect.height;

      var centerX = ( nodeW/2 ) + nodeX,
          centerY = ( nodeH/2 ) + nodeY;

      var relativeX = -(centerX - mouseX),
          relativeY = -(centerY - mouseY);
      
      return {x: relativeX, y: relativeY};
    };  // End getMouseRelativeTo()

    var moveWithMouse = function ( evnt, node ) {

      var distanceToMouse = getMouseRelativeTo( evnt, headshot );
      var relativeX       = distanceToMouse.x,
          relativeY       = distanceToMouse.y;
      var reducedX        = relativeX * 0.7,
          reducedY        = relativeY * 0.7;
      
      // Calc new positions from center
      var newX = nodeLeft + reducedX,
          newY = nodeTop + reducedY;
      
      // Max and min the values so things don't go nuts
      var maxDiff = 10,
          maxX    = nodeLeft + maxDiff, minX = nodeLeft - maxDiff,
          maxY    = nodeTop + maxDiff, minY = nodeTop - maxDiff;
      console.log(nodeTop, minY, maxY)
      console.log(node.style.top)
      
      // No less than min or more than max
      var maxedX = Math.min( maxX, Math.max( minX, newX ) ),
          maxedY = Math.min( maxY, Math.max( minY, newY ) );
      
      // Move node
      // Have to do transition here, not in css, for it to work
      node.style.transition = 'left .5s linear, top .4s linear';
      node.style.left = maxedX + 'px'
      node.style.top  = maxedY + 'px';
      
      return node;
    };  // End moveWithMouse()
    

    var reCenter = function ( node ) {
      // ???: When to recenter? Mouseout fires too often
      node.style.transition = 'all 0.2s + ease-out';
      node.style.left = node.dataset['left'];
      node.style.top = node.dataset['top'];
      return node;
    };  // End reCenter()


    // ---------------- \\
    // --- EVENTS --- \\
    myCard.addEventListener( 'mousemove', function (evnt) {
      var isFlipped = myCard.classList.contains( 'flipped' );
      // Only do the animation if the user can see it
      if ( isFlipped === false ) {
        moveWithMouse( evnt, jamesBondNode );
      }
    } ); 
   
  });
  // ===================
  // End Custom Code
  // ===================


  window.addEventListener('load', function() {
    var myCard = document.querySelector('#mb');
    var flipButtons = Array.prototype.slice.call(myCard.querySelectorAll('i.flip'));
    flipButtons.forEach(function(button) {
      button.addEventListener('click', function() {
        myCard.classList.toggle('flipped');
      });
    });
  });
  </script>
  
</div>